from socket import *
from gmpy2 import *
import string

HOST = '52.175.158.46'
#HOST = 'localhost'
PORT = 40002

def recvuntil(s, str):
   while True:
      if s.recv(1024).find(str) != -1:
         return

def main():
   s = socket(AF_INET, SOCK_STREAM)
   s.connect((HOST,PORT))

   recvuntil(s,"Key Generating is Ended\n")

   EncryptedData = int(s.recv(3025).split()[3])
   PrivateKey = 786371267256868999118226791934671205315942381150986466070164723227031898664334257986514607958014396659742789659745180035755905807112259812686141385646481697446041060233546143065802264778236705432713849318782420960476766245768337475745716577409218780642957154935327976274495058808457709162191385502989583584298322532338147655531771659852230593185887022112840245823694168205827337620426990472043723480651193332590489571039169692472422388655884384934764497429398937027316358806411813745377926837270574791829651761902279360958006452123650101174621683752236097013361048635294895579004953193958409816108280604444276196738084341927378841633504383394442222125990413892770367685056809007029019458707048303055165136101534256153916251246381554841517704856170342444913571075139635598477001610942749726961732215114102585279875654660138137238397756740151396746425597938957525033628113828428601322744283293997103840456545784188964262520332748915486058572579027574203758452321200200373216514327769093664504521234057397214238879220680388074724638616611575836675352954104416318116931456503520212767846336440801243059723603766779422517269256457828355859295754463459192020190861049793438498156036107344590403562269201499186829451114717537083260213039225
   N = 1044388881413152506691752710716624382579964249047383780384233483283953907971557456848826811934997558340890106714439262837987573438185793607263236087851365277945956976543709998340361590134383718314428070011855946226376318839397712745672334684344586617496807908705803704071284048740118609114467977783598029006690697600653450794402499073313655339553833700162307202013282630845566129486279002848586096254031476866169150792712561588286084912360489096086200722815030967777717184920678698120026611906420006892800629990673807045740381567965542428579442736758203240180858489936597121784161788543599325256723713897245258564131378894882215721032454483182663602447410406206605827169895576134734205640381165130412956991982982813624560781237251487840725883976219267677157563885355442227842754369664991260936611978646990570202470864911216177534982510459238429002261957146109354524074258091155400881651699324739110875426250103752411336489340207397621943251616715427383143672581025383482605402570803003488772623873903367163515172010706471506968810059433811270160224272718635182798462613003559659236641594639570465027376724958024431953464028003281075460976002320362078753623631924730508277339588386023508080515190999918781675629931130902752659976197821

   s.send(str(powmod(EncryptedData, PrivateKey, N)))
   print s.recv(1024)
   
main()
